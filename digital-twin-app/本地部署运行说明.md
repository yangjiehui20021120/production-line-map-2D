# 数字孪生生产地图 - 本地部署运行说明

## 📋 项目概述

**项目名称**: 动车组侧墙产线数字孪生地图  
**技术栈**: React + Vite + Tailwind CSS + SVG  
**功能特点**: 实时生产监控、多图层可视化、专题视图切换、交互式数据展示  

## 🎯 主要功能

### 核心功能
- ✅ **实时生产监控**: 10秒自动刷新的KPI指标和生产数据
- ✅ **多专题视图**: Flow流动、Quality质量、Efficiency效率、计划柔性、Spaghetti意面图
- ✅ **图层控制系统**: 11个可切换的可视化图层
- ✅ **主物流路径**: 7条精确连接的生产流程路径
- ✅ **交互式界面**: 工位点击、订单跟踪、设备状态监控

### 可视化图层
1. **🏭 工位状态层**: 显示所有工位的实时状态和周期时间
2. **➡️ 主物流路径**: 7条主要生产流程连接线
3. **📦 在制品位置**: WIP数量和位置显示
4. **⚠️ 瓶颈标识**: 自动识别和标记生产瓶颈
5. **🚨 安灯层**: 实时报警和异常信息
6. **📊 设备OEE层**: 设备综合效率显示
7. **⚙️ 设备状态**: 设备运行状态监控
8. **🏗️ 天车系统**: 天车位置和任务状态
9. **📋 订单位置**: 在制品订单跟踪
10. **🍝 意面图路径**: 复杂物流路径分析

## 🛠️ 环境要求

### 必需软件
- **Node.js**: 版本 16.0 或更高
- **npm**: 版本 7.0 或更高（通常随Node.js安装）
- **现代浏览器**: Chrome 90+, Firefox 88+, Safari 14+, Edge 90+

### 推荐配置
- **操作系统**: Windows 10/11, macOS 10.15+, Ubuntu 18.04+
- **内存**: 4GB RAM 或更高
- **存储**: 至少 500MB 可用空间

## 📦 安装步骤

### 1. 解压项目文件
```bash
# 解压项目包
tar -xzf digital-twin-production-map.tar.gz

# 进入项目目录
cd digital-twin-app
```

### 2. 安装依赖
```bash
# 安装所有项目依赖
npm install

# 如果遇到网络问题，可以使用国内镜像
npm install --registry=https://registry.npmmirror.com
```

### 3. 启动开发服务器
```bash
# 启动开发服务器
npm run dev

# 或者使用
npm start
```

### 4. 访问应用
- 开发服务器启动后，在浏览器中访问: `http://localhost:5173`
- 如果端口被占用，Vite会自动选择其他可用端口

## 🚀 生产部署

### 构建生产版本
```bash
# 构建优化后的生产版本
npm run build
```

### 部署选项

#### 选项1: 静态文件服务器
```bash
# 安装全局静态服务器
npm install -g serve

# 启动静态服务器
serve -s dist -l 3000
```

#### 选项2: Nginx部署
```nginx
server {
    listen 80;
    server_name your-domain.com;
    root /path/to/digital-twin-app/dist;
    index index.html;
    
    location / {
        try_files $uri $uri/ /index.html;
    }
}
```

#### 选项3: Apache部署
```apache
<VirtualHost *:80>
    ServerName your-domain.com
    DocumentRoot /path/to/digital-twin-app/dist
    
    <Directory /path/to/digital-twin-app/dist>
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>
</VirtualHost>
```

## 🎮 使用指南

### 界面布局
- **左侧面板**: 专题视图切换、图层控制、功能按钮
- **右侧地图**: 主要的可视化区域
- **顶部KPI**: 6个关键生产指标实时显示

### 操作说明

#### 专题视图切换
1. 点击左侧面板的专题视图按钮
2. 每个专题会自动激活相关图层
3. 可以手动调整图层显示

#### 图层控制
1. 勾选/取消勾选图层复选框
2. 灰色图层为未实现功能
3. 图层可以任意组合显示

#### 交互功能
- **工位点击**: 点击工位查看详细信息
- **订单跟踪**: 点击"显示订单列表"查看在制品
- **缩放控制**: 使用右下角缩放按钮

### 主物流路径说明
系统显示7条主要生产流程路径：
1. **组焊→修补** (橙色, 8件)
2. **修补→组焊** (绿色, 12件)  
3. **组焊→调修** (黄色, 15件)
4. **调修→打磨** (青色, 18件)
5. **打磨→加工** (紫色, 22件)
6. **加工→精磨** (红色, 25件)
7. **精磨→附件** (绿色, 9件)

## 🔧 配置说明

### 数据刷新间隔
- 默认: 10秒自动刷新
- 修改位置: `src/components/RealProductionMap.jsx` 第613行
```javascript
}, 10000); // 修改这个数值（毫秒）
```

### 颜色主题
- 配置位置: `src/components/RealProductionMap.jsx` 第17-30行
- 可以修改各种状态的颜色定义

### 工位布局
- 配置位置: `src/components/RealProductionMap.jsx` 第45-120行
- 可以调整工位坐标和属性

## 🐛 常见问题

### Q1: 安装依赖时出现错误
**解决方案**:
```bash
# 清除npm缓存
npm cache clean --force

# 删除node_modules重新安装
rm -rf node_modules package-lock.json
npm install
```

### Q2: 开发服务器无法启动
**解决方案**:
```bash
# 检查端口占用
netstat -ano | findstr :5173

# 指定其他端口启动
npm run dev -- --port 3000
```

### Q3: 构建失败
**解决方案**:
```bash
# 检查Node.js版本
node --version

# 更新到最新版本
npm update
```

### Q4: 浏览器显示空白页面
**解决方案**:
1. 检查浏览器控制台错误信息
2. 确认浏览器版本支持ES6+
3. 尝试清除浏览器缓存

## 📁 项目结构

```
digital-twin-app/
├── public/                 # 静态资源
├── src/
│   ├── components/
│   │   └── RealProductionMap.jsx  # 主组件
│   ├── App.jsx            # 应用入口
│   └── main.jsx           # React入口
├── package.json           # 项目配置
├── vite.config.js         # Vite配置
└── tailwind.config.js     # Tailwind配置
```

## 🔄 更新维护

### 数据源更新
- 当前使用模拟数据生成
- 可以替换为真实API接口
- 修改位置: `generateRealProductionData()` 函数

### 功能扩展
- 添加新图层: 在 `layerConfigs` 中配置
- 新增专题视图: 在 `viewConfigs` 中添加
- 自定义工位: 修改 `workstations` 数组

## 📞 技术支持

如果在部署或使用过程中遇到问题，请检查：
1. Node.js和npm版本是否符合要求
2. 网络连接是否正常
3. 浏览器是否支持现代JavaScript特性
4. 防火墙是否阻止了端口访问

## 📄 许可证

本项目为内部使用版本，包含完整的数字孪生生产地图功能。

---

**版本**: v1.0.0  
**最后更新**: 2025年9月10日  
**开发环境**: React 18 + Vite 6 + Tailwind CSS 3

